import{u as H,a as J,g as K,c as S,o as O,r as n,b as Q,B as o,C as W,d as u,k as B,$ as X,w as s,i as y,f as i,m as L,t as V,j as c,e as w,F as Y,v as Z,n as D,l as ee,p as te}from"./index-iCREqSRD.js";import{s as le}from"./index-B2XWp6uk.js";import{l as b}from"./index-CNLIsO_i.js";const oe={class:"card-header"},ae={key:0},ne={key:1},se={style:{"font-weight":"lighter"}},ie={class:"card-footer"},de={__name:"log",props:{type:String,historical:Boolean},setup(P,{expose:U}){const a=P,{t:p}=H(),{isMobile:v}=J(),k=K(),q=S(()=>k.isDark);S(()=>k.language),O(()=>{a.historical?N():(x(),I())});const I=()=>{v.value?r.value.line=20:r.value.line=25},g=n(1),r=n({line:25,type:a.type}),d=n(""),F=()=>{b.logValue.get(r.value).then(l=>{d.value=l.data.join(`
`)})};let m=null;const x=()=>{m=setInterval(()=>{g.value===1&&F()},2e3)},h=()=>{m&&(clearInterval(m),m=null)},C=n([]),_=n(""),N=()=>{const l={type:a.type};b.historical.logFile.get(l).then(e=>{C.value=e.data})},f=n(!1),j=()=>{f.value=!0;const l={file:_.value};b.historical.log.get(l).then(e=>{d.value=e.data}).finally(()=>{f.value=!1})};return Q(()=>{h(),window.removeEventListener("beforeunload",h)}),U({cancelRequests:h,startRequests:x}),(l,e)=>{const E=o("el-option"),$=o("el-select"),z=o("el-switch"),M=o("el-input-number"),R=o("el-button"),T=o("el-tooltip"),A=o("el-card"),G=W("loading");return u(),B(A,{style:te(c(v)?"min-height: 500px":"min-height: 700px"),shadow:"never"},X({header:s(()=>[y("div",oe,[L(V(c(p)("logs.logs"))+" ",1),a.historical?(u(),w("div",ae,[i($,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t),size:"default",style:{width:"10vw","font-weight":"lighter"},onChange:j},{default:s(()=>[(u(!0),w(Y,null,Z(C.value,t=>(u(),B(E,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])):D("",!0),a.historical?D("",!0):(u(),w("div",ne,[y("span",se,V(c(p)("logs.autoPull")),1),i(z,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=t=>g.value=t),"active-value":1,"inactive-value":0},null,8,["modelValue"])]))])]),default:s(()=>[ee(i(le,{ref:"editor",modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=t=>d.value=t),height:c(v)?420:600,theme:q.value?"darcula":"idea",mode:"javascript",style:{width:"100%"}},null,8,["modelValue","height","theme"]),[[G,f.value]])]),_:2},[a.historical?void 0:{name:"footer",fn:s(()=>[y("div",ie,[i(M,{modelValue:r.value.line,"onUpdate:modelValue":e[3]||(e[3]=t=>r.value.line=t),"controls-position":"right",style:{width:"100px"}},null,8,["modelValue"]),i(T,{content:l.$t("logs.manualPullTips"),effect:"light",placement:"top"},{default:s(()=>[i(R,{style:{"margin-left":"10px"},type:"primary",onClick:F},{default:s(()=>[L(V(c(p)("logs.manualPull")),1)]),_:1})]),_:1},8,["content"])])]),key:"0"}]),1032,["style"])}}};export{de as default};
