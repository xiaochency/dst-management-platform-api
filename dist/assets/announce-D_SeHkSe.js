import{u as G,a as H,g as J,c as M,o as K,r as b,Z as w,B as u,d as _,e as L,f as e,w as n,p as Q,j as c,i as h,m as i,t as r,k as V,X as Y,ad as D,A as ee,y as A,x as ne,z as le}from"./index-iCREqSRD.js";const oe={class:"page-div"},te={class:"card-header"},ae={class:"el-form-item-msg"},se={class:"dialog-footer"},ue=Y({name:"toolsAnnounce"}),ie=Object.assign(ue,{setup(ce){const{t}=G(),{isMobile:g}=H(),C=J();M(()=>C.isDark),M(()=>C.language),K(()=>{v()});const q=b([]),v=()=>{w.announce.get().then(o=>{q.value=o.data})},y=b(""),S=()=>{s.value={name:"",enable:!0,content:"",frequency:600},D(()=>{m.value.clearValidate()}),y.value="post",d.value=!0},d=b(!1),m=b(),s=b({name:"",enable:!0,content:"",frequency:600}),z={name:[{required:!0,message:t("tools.announce.rules.name"),trigger:"blur"}],enable:[{required:!0,message:t("tools.announce.rules.enable"),trigger:"change"}],content:[{required:!0,message:t("tools.announce.rules.content"),trigger:"blur"}],frequency:[{required:!0,message:t("tools.announce.rules.frequency"),trigger:"blur"}]},T=()=>{if(s.value.frequency<1){ee(t("tools.announce.rules.frequencyMin"));return}switch(y.value){case"post":U();break;case"put":x();break}},U=()=>{m.value.validate(o=>{o&&w.announce.post(s.value).then(l=>{d.value=!1,A(l.message),v()})})},E=o=>{ne.confirm(t("tools.announce.deleteTip"),"Warning",{confirmButtonText:t("tools.announce.confirm"),cancelButtonText:t("tools.announce.cancel"),type:"warning"}).then(()=>{w.announce.delete(o).then(l=>{A(l.message),v()})}).catch(()=>{le(t("home.canceled"))})},F=o=>{s.value=o,D(()=>{m.value.clearValidate()}),y.value="put",d.value=!0},x=()=>{m.value.validate(o=>{o&&w.announce.put(s.value).then(l=>{d.value=!1,A(l.message),v()})})};return(o,l)=>{const p=u("el-button"),f=u("el-table-column"),B=u("el-tag"),N=u("el-table"),R=u("el-result"),j=u("el-card"),I=u("el-col"),P=u("el-row"),$=u("el-input"),k=u("el-form-item"),O=u("el-switch"),W=u("el-form"),X=u("el-dialog");return _(),L("div",oe,[e(P,{gutter:10},{default:n(()=>[e(I,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:n(()=>[e(j,{style:Q(c(g)?"min-height: 500px":"min-height: 700px"),shadow:"never"},{header:n(()=>[h("div",te,[i(r(c(t)("tools.announce.title"))+" ",1),h("div",null,[e(p,{size:"default",type:"success",onClick:S},{default:n(()=>[i(r(c(t)("tools.announce.new")),1)]),_:1})])])]),default:n(()=>[q.value.length>0?(_(),V(N,{key:0,data:q.value,border:"",size:"small",style:{width:"100%"},"tooltip-effect":"light"},{default:n(()=>[e(f,{label:o.$t("tools.announce.name"),prop:"name"},null,8,["label"]),e(f,{label:o.$t("tools.announce.isEnable"),prop:"enable"},{default:n(a=>[a.row.enable?(_(),V(B,{key:0,type:"success"},{default:n(()=>[i(r(c(t)("tools.announce.enable")),1)]),_:1})):(_(),V(B,{key:1,type:"danger"},{default:n(()=>[i(r(c(t)("tools.announce.disable")),1)]),_:1}))]),_:1},8,["label"]),e(f,{label:o.$t("tools.announce.frequency"),prop:"frequency"},{default:n(a=>l[6]||(l[6]=[])),_:1},8,["label"]),e(f,{label:o.$t("tools.announce.content"),prop:"content","show-overflow-tooltip":""},{default:n(a=>l[7]||(l[7]=[])),_:1},8,["label"]),e(f,{label:o.$t("tools.announce.actions"),fixed:"right",prop:"actions",width:"140"},{default:n(a=>[e(p,{link:"",type:"primary",onClick:Z=>F(a.row)},{default:n(()=>[i(r(c(t)("tools.announce.update")),1)]),_:2},1032,["onClick"]),e(p,{link:"",type:"danger",onClick:Z=>E(a.row)},{default:n(()=>[i(r(c(t)("tools.announce.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])):(_(),V(R,{key:1,title:o.$t("tools.announce.noData"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1},8,["style"])]),_:1})]),_:1}),e(X,{modelValue:d.value,"onUpdate:modelValue":l[5]||(l[5]=a=>d.value=a),"close-on-click-modal":!1,title:o.$t("tools.announce.new"),width:"60%"},{footer:n(()=>[h("div",se,[e(p,{onClick:l[4]||(l[4]=a=>d.value=!1)},{default:n(()=>[i(r(c(t)("tools.announce.cancel")),1)]),_:1}),e(p,{type:"primary",onClick:T},{default:n(()=>[i(r(c(t)("tools.announce.submit")),1)]),_:1})])]),default:n(()=>[e(W,{ref_key:"announceFormRef",ref:m,"label-position":c(g)?"top":"left","label-width":c(g)?"70":"auto",model:s.value,rules:z,size:c(g)?"small":"large"},{default:n(()=>[e(k,{label:o.$t("tools.announce.name"),prop:"name"},{default:n(()=>[e($,{modelValue:s.value.name,"onUpdate:modelValue":l[0]||(l[0]=a=>s.value.name=a),disabled:y.value==="put"},null,8,["modelValue","disabled"])]),_:1},8,["label"]),e(k,{label:o.$t("tools.announce.isEnable"),prop:"enable"},{default:n(()=>[e(O,{modelValue:s.value.enable,"onUpdate:modelValue":l[1]||(l[1]=a=>s.value.enable=a)},null,8,["modelValue"])]),_:1},8,["label"]),e(k,{label:o.$t("tools.announce.content"),prop:"content"},{default:n(()=>[e($,{modelValue:s.value.content,"onUpdate:modelValue":l[2]||(l[2]=a=>s.value.content=a)},null,8,["modelValue"])]),_:1},8,["label"]),e(k,{label:o.$t("tools.announce.frequency"),prop:"frequency"},{default:n(()=>[e($,{modelValue:s.value.frequency,"onUpdate:modelValue":l[3]||(l[3]=a=>s.value.frequency=a),modelModifiers:{number:!0},min:1,step:1},null,8,["modelValue"]),h("div",ae,r(c(t)("tools.announce.frequencyTip")),1)]),_:1},8,["label"])]),_:1},8,["label-position","label-width","model","size"])]),_:1},8,["modelValue","title"])])}}});export{ie as default};
